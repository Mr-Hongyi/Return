@page "/retrospective/{retroId}/lobby"
@using System.Threading
@using Return.Application.Retrospectives.Queries.GetRetrospectiveStatus
@using Return.Domain.Entities
@inherits MediatorComponent

@if (this.RetrospectiveStatus == null)
{
    return;
}

<h1 class="title has-text-centered">Retrospective: @this.RetrospectiveStatus.Title</h1>

<div class="columns">
    <CascadingValue Value=@this.RetrospectiveStatus Name="RetrospectiveStatus">
        <div class="column is-three-quarters">
           <div class="columns">
               @foreach (RetrospectiveLane lane in this.RetrospectiveStatus.Lanes)
               {
                   <div class="column">
                       <NoteLane @key="lane.Id" Lane="@lane" RetroId="@this.RetroId"/>
                   </div>
               }
           </div>
        </div>
    </CascadingValue>

    <div class="column">
        <RetrospectiveOnlineList RetroId="@this.RetroId"/>
    </div>
</div>


@code {
    #nullable disable

    [Parameter]
    public string RetroId { get; set; }

    public RetrospectiveStatus RetrospectiveStatus { get; set; } = null;

    protected override async Task OnInitializedAsync()
    {
        this.RetrospectiveStatus = await this.Mediator.Send(new GetRetrospectiveStatusQuery(this.RetroId));
    }
}
